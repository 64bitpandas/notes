<!doctype html><html lang=en dir=ltr><head><meta property="og:title" content="SQL Basics"><meta property="og:description" content="What is SQL? #  Structured Query Language (/ˈsiːkwəl/) is a highly standardized syntax for performing operations on a database.
Terminology #  SQL databases are a set of named relations, or tables, that describe the relationship between attributes. You can think of attributes as the columns of the table, and each record (also known as a tuple) being one row in the table.
Relations are composed of:
 A schema, which is the description of the table."><meta property="og:type" content="article"><meta property="og:url" content="https://notes.bencuan.me/cs186/00-SQL-Basics/"><meta property="article:section" content="cs186"><meta property="article:modified_time" content="2023-01-07T12:32:44-08:00"><meta property="og:site_name" content="🗒️ Ben's Notes"><title>SQL Basics | 🗒️ Ben's Notes</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.4c35079369dcb636c1f2ee6d9d89b3ea930d29398065746c2a5856a3b3133e82.css integrity="sha256-TDUHk2nctjbB8u5tnYmz6pMNKTmAZXRsKlhWo7MTPoI=" crossorigin=anonymous><meta charset=utf-8><meta name=description content="What is SQL? #  Structured Query Language (/ˈsiːkwəl/) is a highly standardized syntax for performing operations on a database.
Terminology #  SQL databases are a set of named relations, or tables, that describe the relationship between attributes. You can think of attributes as the columns of the table, and each record (also known as a tuple) being one row in the table.
Relations are composed of:
 A schema, which is the description of the table."><title>SQL Basics</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://notes.bencuan.me//favicon.png><link href=https://notes.bencuan.me/styles.e08ceb33360cec132feb69cfb982e2a4.min.css rel=stylesheet><link href=https://notes.bencuan.me/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://notes.bencuan.me/quartz/js/darkmode.9d3e1c1ebec61822893ee54cff5423d0.min.js></script>
<script src=https://notes.bencuan.me/quartz/js/util.c69e233dc1cc331a30b0f670e657b425.min.js></script>
<script async src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script async src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://notes.bencuan.me/quartz/js/popover.f03552ccb84d99ca615d1cfb9abde59e.min.js></script>
<script defer src=https://notes.bencuan.me/quartz/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://notes.bencuan.me/quartz/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://notes.bencuan.me/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://notes.bencuan.me/",fetchData=Promise.all([fetch("https://notes.bencuan.me/indices/linkIndex.50761b896cebe53546cda8ee515ad7e1.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://notes.bencuan.me/indices/contentIndex.a80f41b1579041248e4e517dd5ba81f6.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addCollapsibleCallouts(),initPopover("https://notes.bencuan.me",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!0;drawGraph("https://notes.bencuan.me",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script>window.Million={navigate:e=>window.location.href=e,prefetch:()=>{}},window.addEventListener("DOMContentLoaded",()=>{init(),render()})</script></head><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://notes.bencuan.me/quartz/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><header class=book-header><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h1 id=page-title><a href=https://notes.bencuan.me/>🗒️ Ben's Notes</a></h1><div class=spacer></div><div id=search-icon class=quartz-search><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control><main class=flex><aside class=book-menu><div class=book-menu-content><nav><div class=menu-search><div id=search-icon class=quartz-search><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div></div><ul><li><input type=checkbox id=section-da99de074169576d9f77860d41691a68 class=toggle>
<label for=section-da99de074169576d9f77860d41691a68 class="flex justify-between"><a href=/cs61b/ class=book-collapse-toggle>CS 61B</a></label><ul><li><span class=book-menu-title>Object Oriented Programming</span><ul><li><a href=/cs61b/oop/inheritance/>Inheritance</a></li><li><a href=/cs61b/oop/access-control/>Access Control</a></li><li><a href=/cs61b/oop/dynamic-method-selection/>Dynamic Method Selection</a></li><li><a href=/cs61b/oop/objects/>Java Objects</a></li><li><a href=/cs61b/oop/generics/>Generic Types</a></li></ul></li><li><span class=book-menu-title>Asymptotics</span><ul><li><a href=/cs61b/asymptotics/asymptotics/>Asymptotic Analysis Basics</a></li><li><a href=/cs61b/asymptotics/amortization/>Amortization</a></li><li><a href=/cs61b/asymptotics/asymptotics-practice/>Asymptotics Practice</a></li></ul></li><li><span class=book-menu-title>Abstract Data Types</span><ul><li><input type=checkbox id=section-70dba6a254ce0b2bcdb77dd58dbf6cdc class=toggle>
<label for=section-70dba6a254ce0b2bcdb77dd58dbf6cdc class="flex justify-between"><a href=/cs61b/abstract-data-types/collections/ class=book-collapse-toggle>Collections</a></label><ul><li><a href=/cs61b/abstract-data-types/collections/arrays/>Arrays</a></li><li><a href=/cs61b/abstract-data-types/collections/linked-lists/>Linked Lists</a></li><li><a href=/cs61b/abstract-data-types/collections/sets/>Sets</a></li><li><a href=/cs61b/abstract-data-types/collections/stacks-and-queues/>Stacks and Queues</a></li></ul></li><li><input type=checkbox id=section-5eb2d5b415a82a45c7861774887e844b class=toggle>
<label for=section-5eb2d5b415a82a45c7861774887e844b class="flex justify-between"><a href=/cs61b/abstract-data-types/binary-trees/ class=book-collapse-toggle>Binary Trees</a></label><ul><li><a href=/cs61b/abstract-data-types/binary-trees/balanced-search-structures/>Balanced Search Structures</a></li><li><a href=/cs61b/abstract-data-types/binary-trees/heaps/>Heaps</a></li><li><a href=/cs61b/abstract-data-types/binary-trees/tries/>Tries</a></li></ul></li><li><a href=/cs61b/abstract-data-types/graphs/>Graphs</a></li><li><a href=/cs61b/abstract-data-types/hashing/>Hashing and Hash Tables</a></li><li><a href=/cs61b/abstract-data-types/union-find-disjoint-sets/>Union Find (Disjoint Sets)</a></li><li><a href=/cs61b/abstract-data-types/comparables-and-comparators/>Comparables and Comparators</a></li></ul></li><li><span class=book-menu-title>Algorithms</span><ul><li><input type=checkbox id=section-26838f44377a3dfc0925929b8b82de69 class=toggle>
<label for=section-26838f44377a3dfc0925929b8b82de69 class="flex justify-between"><a href=/cs61b/algorithms/searching/ class=book-collapse-toggle>Searching</a></label><ul><li><a href=/cs61b/algorithms/searching/binary-search/>Binary Search</a></li><li><a href=/cs61b/algorithms/searching/breadth-first-search-bfs/>Breadth First Search (DFS)</a></li><li><a href=/cs61b/algorithms/searching/depth-first-search-dfs/>Depth First Search (DFS)</a></li></ul></li><li><input type=checkbox id=section-fd5238a874e42ff4e1ab0e65c20a9824 class=toggle>
<label for=section-fd5238a874e42ff4e1ab0e65c20a9824 class="flex justify-between"><a href=/cs61b/algorithms/shortest-paths/ class=book-collapse-toggle>Shortest Paths</a></label><ul><li><a href=/cs61b/algorithms/shortest-paths/dijkstras-algorithm/>Dijkstra's Algorithm</a></li><li><a href=/cs61b/algorithms/shortest-paths/a-search/>A* Search</a></li></ul></li><li><input type=checkbox id=section-434cf8cf80558e0886666bff24d740d1 class=toggle>
<label for=section-434cf8cf80558e0886666bff24d740d1 class="flex justify-between"><a href=/cs61b/algorithms/minimum-spanning-trees/ class=book-collapse-toggle>Minimum Spanning Trees</a></label><ul><li><a href=/cs61b/algorithms/minimum-spanning-trees/kruskals-algorithm/>Kruskal's Algorithm</a></li><li><a href=/cs61b/algorithms/minimum-spanning-trees/prims-algorithm/>Prim's Algorithm</a></li></ul></li><li><a href=/cs61b/algorithms/sorting/>Sorting</a></li><li><a href=/cs61b/algorithms/minimax/>Minimax Algorithm</a></li></ul></li><li><span class=book-menu-title>Misc. Topics</span><ul><li><a href=/cs61b/misc-topics/exceptions/>Exceptions</a></li><li><a href=/cs61b/misc-topics/modular-arithmetic/>Modular Arithmetic</a></li><li><a href=/cs61b/misc-topics/more-resources/>More Resources</a></li></ul></li></ul></li><li><input type=checkbox id=section-6d80b867b0e7b10bf4afdb6cb30147b7 class=toggle checked>
<label for=section-6d80b867b0e7b10bf4afdb6cb30147b7 class="flex justify-between"><a href=/cs186/ class=book-collapse-toggle>CS 186</a></label><ul><li><a href=/cs186/io/>What is an I/O and why should I care?</a></li><li><a href=/cs186/01-Disks-Buffers-Files/>01 Disks, Buffers, Files</a></li><li><a href=/cs186/02-Cost-Analysis/>02 Cost Analysis</a></li><li><a href=/cs186/03-B+-Trees/>03 B Trees</a></li><li><a href=/cs186/04-Sorting-and-Hashing/>04 Sorting and Hashing</a></li><li><a href=/cs186/05-Iterators-and-Joins/>05 Iterators and Joins</a></li><li><a href=/cs186/06-Relational-Algebra/>06 Relational Algebra</a></li><li><a href=/cs186/07-Query-Optimization/>07 Query Optimization</a></li><li><a href=/cs186/08-Transactions/>08 Transactions</a></li><li><a href=/cs186/09-Parallel-Query-Processing/>09 Parallel Query Processing</a></li><li><a href=/cs186/10-Recovery/>10 Recovery</a></li><li><a href=/cs186/11-Distributed-Transactions/>11 Distributed Transactions</a></li><li><a href=/cs186/12-ER-Diagrams/>12 Er Diagrams</a></li><li><a href=/cs186/13-Extras/>13 Extras</a></li><li><a href=/cs186/00-SQL-Basics/ class=active>SQL Basics</a></li></ul></li></ul><ul><li><a href=/contributing target=_blank rel=noopener>Contribute</a></li><li><a href=https://github.com/64bitpandas/notes/issues target=_blank rel=noopener>Feedback</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class="book-page container"><article class=markdown><h1 class=title>SQL Basics</h1><h2 id=what-is-sql>What is SQL?
<a class=anchor href=#what-is-sql>#</a></h2><p><strong>S</strong>tructured <strong>Q</strong>uery <strong>L</strong>anguage (/ˈsiːkwəl/) is a highly standardized syntax for performing operations on a <strong>database</strong>.</p><h3 id=terminology>Terminology
<a class=anchor href=#terminology>#</a></h3><p>SQL databases are a set of named <strong>relations</strong>, or tables, that describe the relationship between <strong>attributes</strong>. You can think of attributes as the columns of the table, and each record (also known as a <strong>tuple</strong>) being one row in the table.</p><p>Relations are composed of:</p><ul><li>A <strong>schema</strong>, which is the description of the table. Schemas are fixed, with unique attribute names and atomic types (integer, text, etc.).</li><li>The <strong>instance</strong>, which is the set of data that satisfy the schema. Instances can frequently change (whenever a row is added or updated), as long as any additions are consistent with the schema.</li></ul><p>As an example for using this terminology: if we add a column to the table, we can say that &ldquo;we updated the schema of the relation to include an additional attribute&rdquo;.</p><h3 id=a-note-on-looking-up-sql-things-online>A note on looking up SQL things online
<a class=anchor href=#a-note-on-looking-up-sql-things-online>#</a></h3><p>The SQL syntax and features we cover in this course are known as &ldquo;standard SQL&rdquo;, whose specifications can be found
<a href=https://blog.ansi.org/2018/10/sql-standard-iso-iec-9075-2016-ansi-x3-135/ rel=noopener>here</a>.</p><p>In the wild, there are many implementations of SQL (like SQLite, MySQL, MariaDB), which may have an extended feature set or slightly different syntax. We will generally stay away from these extended features, and you do not need to know them for now.</p><p>If you&rsquo;re struggling to find relevant information, I would recommend prepending &ldquo;sqlite&rdquo; to the front of your search query (e.g. &ldquo;sqlite how to create a table&rdquo;). We use SQLite in Project 1, and for most things it&rsquo;s safe to assume that the syntax will be what we&rsquo;re looking for. Read more about SQL vs SQLite
<a href=https://cs186.gitbook.io/project/assignments/proj1/sql-vs-sqlite rel=noopener>here</a>.</p><h3 id=running-sql-queries>Running SQL queries
<a class=anchor href=#running-sql-queries>#</a></h3><p>You will install sqlite3 in
<a href=https://cs186.gitbook.io/project/assignments/proj1/getting-started rel=noopener>Project 1</a>. Once you&rsquo;ve installed it, you can run <code>sqlite3</code> in your terminal to start an interactive session, or run <code>sqlite3 database.db</code> to read from a file named <code>database.db</code>. Once in the session, you can also run <code>.read file.sql</code> to run queries written in the file <code>file.sql</code>, or run <code>.schema</code> to get schema information for the current database.</p><p>In a pinch, the
<a href=https://code.cs61a.org/ rel=noopener>CS61A online interpreter</a> also works great, and has a built-in visualizer that&rsquo;s especially useful for exploring aggregation.</p><h3 id=pedagogy-note>Pedagogy note
<a class=anchor href=#pedagogy-note>#</a></h3><p>Don&rsquo;t get too hung up on the syntax, or remembering how to use every small feature of SQL. The language itself is only a small part of this course- for most of our time, we&rsquo;ll discuss how to actually <em>implement</em> the features you use here.</p><p>If you anticipate needing SQL in future work,
<a href=https://www.w3schools.com/sql/sql_ref_keywords.asp rel=noopener>here&rsquo;s a nice reference</a> for common keywords and how to use them.</p><h2 id=keys>Keys
<a class=anchor href=#keys>#</a></h2><p>When defining schemas, it&rsquo;s often important to be able to guarantee that rows are unique so that we can catch duplicate information. For example, if the school had a database of all enrolled students, we wouldn&rsquo;t want two students to have the same SID!</p><h3 id=primary-keys>Primary Keys
<a class=anchor href=#primary-keys>#</a></h3><p>Primary keys are unique, non-null, and can be used to identify an entry. Many times, adding <code>PRIMARY KEY (id)</code> during
<a rel=noopener class="internal-link broken" data-src=#Create%20Table>table creation</a> is good enough.</p><p>In other cases, like the boat reservation tracking example in lecture, we would need more than one attribute (<code>PRIMARY KEY (sid, bid, day)</code>) to guarantee uniqueness, since a boat can be reserved many different times.</p><h3 id=foreign-keys>Foreign Keys
<a class=anchor href=#foreign-keys>#</a></h3><p>Foreign keys reference other tables&rsquo; primary keys. Building onto the boat example, the boat ID would be the same as the ID’s in a table of boats, so we could add <code>FOREIGN KEY (bid) REFERENCES Boats</code> to the reserves table instead of copying everything over.</p><p>The main purpose of foreign keys is to maintain the uniqueness and non-null constraint of an attribute, since it <em>has</em> to match the primary key of another table.</p><p>Below is a screenshot from lecture that puts some code to the example.
<img src=https://notes.bencuan.me/cs186/SQL%20Basics/Untitled.png width=auto alt="lecture screenshot"></p><h2 id=writing-queries>Writing Queries
<a class=anchor href=#writing-queries>#</a></h2><p>Enough with the long complicated words, let&rsquo;s write some SQL!</p><h3 id=create-table>Create Table
<a class=anchor href=#create-table>#</a></h3><p>First, let&rsquo;s create a table:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> clubs(
</span></span><span style=display:flex><span>	name TEXT,
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>alias</span> TEXT,
</span></span><span style=display:flex><span>	members INTEGER,
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (name)
</span></span><span style=display:flex><span>) <span style=color:#66d9ef>AS</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#e6db74>&#34;Computer Science Mentors&#34;</span>, <span style=color:#e6db74>&#34;CSM&#34;</span>, <span style=color:#ae81ff>500</span> <span style=color:#66d9ef>UNION</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#e6db74>&#34;Open Computing Facility&#34;</span>, <span style=color:#e6db74>&#34;OCF&#34;</span>, <span style=color:#ae81ff>50</span>;
</span></span></code></pre></div><p><a href=https://www.digitalocean.com/community/tutorials/sql-data-types rel=noopener>Here&rsquo;s a good list of common data types that you can use.</a> For the purposes of this class we will mostly focus on INT, BOOLEAN, TEXT, CHAR(n), VARCHAR(n), and BYTE. More about what these do in the
<a href=/cs186/01-Disks-Buffers-Files/ rel=noopener class=internal-link data-src=/cs186/01-Disks-Buffers-Files/>next section</a>.</p><h3 id=insert-values>Insert Values
<a class=anchor href=#insert-values>#</a></h3><p>There&rsquo;s more clubs to add! Let&rsquo;s add one after the table has already been created:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clubs <span style=color:#66d9ef>VALUES</span>
</span></span><span style=display:flex><span>	(<span style=color:#e6db74>&#34;Eta Kappa Nu&#34;</span>, <span style=color:#e6db74>&#34;HKN&#34;</span>, <span style=color:#ae81ff>100</span>),
</span></span><span style=display:flex><span>	(<span style=color:#e6db74>&#34;Computer Science Association&#34;</span>, <span style=color:#e6db74>&#34;CSUA&#34;</span>, <span style=color:#ae81ff>200</span>);
</span></span></code></pre></div><h3 id=basic-querying>Basic Querying
<a class=anchor href=#basic-querying>#</a></h3><p>Below is the basic structure of a query:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> name <span style=color:#66d9ef>AS</span> clubname
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> clubs
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> members <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>100</span> <span style=color:#66d9ef>AND</span> members <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>300</span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> clubname
</span></span><span style=display:flex><span><span style=color:#66d9ef>LIMIT</span> <span style=color:#ae81ff>3</span>;
</span></span></code></pre></div><p>Here, we:</p><ul><li>SELECT the column <code>name</code> FROM the table <code>clubs</code>, and rename it to <code>clubname</code>;</li><li>Keep only the clubs WHERE the number of members is between 100 and 300;</li><li>Sort the entries by name (ascending by default),</li><li>and keep only the top 3 entries (by alphabetical order).</li></ul><h3 id=aggregation>Aggregation
<a class=anchor href=#aggregation>#</a></h3><p>Aggregation can seem tricky, but the core idea is simple: <strong>crunch similar rows into one row, and keep one particularly interersting value.</strong></p><p>There are three parts to this:</p><ol><li><strong>GROUP BY:</strong> Specify the column containing the similar values. All rows with the same value in this column will be combined into one row.</li><li><strong>HAVING:</strong> Specify how you want to filter (this is optional.) The syntax is basically the same as <code>WHERE</code>, except instead of a column name, we use an aggregate on a column name (such as <code>MAX(members)</code> or <code>COUNT(*)</code>).</li><li>Modifications to <strong>SELECT:</strong> Ensure that all of the selected columns (except the one(s) passed into GROUP BY) are aggregates (MAX, MIN, COUNT, SUM&mldr;).</li></ol><p>It&rsquo;s possible to GROUP BY multiple columns. This will group together every combination of values in those two columns. For example, if we did <code>GROUP BY name, alias</code>, and two clubs <code>Open Computing Facility</code> and <code>Original Cat Friends</code> had the same alias <code>OCF</code>, they would represent two separate groups.</p><div class=book-tabs><input type=radio class=toggle name=tabs-qc id=tabs-qc-0 checked>
<label for=tabs-qc-0>Quick Check</label><div class="book-tabs-content markdown-inner">What is the difference between <code>WHERE</code> and <code>HAVING</code>?</div><input type=radio class=toggle name=tabs-qc id=tabs-qc-1>
<label for=tabs-qc-1>Answer</label><div class="book-tabs-content markdown-inner"><p>In short, <code>WHERE</code> operates on individual rows, and <code>HAVING</code> operates on groups.</p><p>Whenever you want to do something that requires the <code>GROUP BY</code> to have been done first, like filter by <code>MAX(members) > 100</code>, it needs to be in the <code>HAVING</code> clause.</p></div></div><h3 id=practice-problems>Practice Problems
<a class=anchor href=#practice-problems>#</a></h3><p>Still unsure about querying and aggregation?
<a rel=noopener class="internal-link broken" data-src=coursenotes/61A%20Discussion%2012.pdf>Here are some of my old 61A discussion slides</a> that have some practice problems (back when we still taught SQL). All of the tables referenced are already preloaded for you in
<a href=https://code.cs61a.org rel=noopener>code.cs61a.org</a>.</p><h2 id=logical-processing-order>Logical Processing Order
<a class=anchor href=#logical-processing-order>#</a></h2><p>SQL Queries are typically processed in a different order than they&rsquo;re written. Here&rsquo;s the order- try to develop an intuition as to why this order would make more sense to a machine than how queries are usually written:</p><ol><li><code>FROM</code> (find the table that is being referenced, join if needed)</li><li><code>WHERE</code> (filters out rows)</li><li><code>GROUP BY</code> (aggregate)</li><li><code>HAVING</code> (filters out groups)</li><li><code>SELECT</code> (choose columns)</li><li><code>ORDER BY</code> (sort)</li><li><code>LIMIT</code> (cut off the output)</li></ol><p>When writing queries, I often like to follow this order as well since each step builds on the previous one.</p><h3 id=a-note-on-aliasing>A note on aliasing
<a class=anchor href=#a-note-on-aliasing>#</a></h3><p>One consequence of Logical Processing Order is that <strong>we cannot use aliases in WHERE, GROUP BY, or HAVING</strong> because they are processed before any alias is defined in SELECT!</p><p>For example, <code>SELECT name as clubname WHERE clubname = 'Open Computing Facility'</code> is NOT a valid query in standard SQL.</p><p>However, since ORDER BY and LIMIT come afterwards, we are allowed to use aliases there.</p><h2 id=joins>Joins
<a class=anchor href=#joins>#</a></h2><p><img src=https://notes.bencuan.me/cs186/SQL%20Basics/Untitled%201.png width=auto alt=Untitled>
If we have two tables and need to access information from both in a query, we will need to join the two tables together!</p><p>For this section, we will use the following tables as examples:
<img src=https://notes.bencuan.me/cs186/Pasted%20image%2020230107122706.png width=auto alt></p><h3 id=cartesian-product>Cartesian Product
<a class=anchor href=#cartesian-product>#</a></h3><p>By default, if a join (<code>SELECT ... FROM a, b...</code>) is done in SQL without specifying a type, a <strong>cross product</strong> (Cartesian product) is calculated. Every row in table <code>a</code> (the left table) is combined with every row in table <code>b</code> to create $R_a * R_b$ rows ($R_a$ = number of rows in table <code>a</code>).</p><p>In the example below, since <code>clubs</code> had $2$ rows and <code>members</code> had $4$ rows, we should expect the result to have $3 \times 4 = 12$ rows. Note that most of these rows are pretty useless, since there is no correlation between the member and the club they were joined with.
<img src=https://notes.bencuan.me/cs186/Pasted%20image%2020230107122726.png width=500 alt=|500></p><h3 id=inner-join>Inner Join
<a class=anchor href=#inner-join>#</a></h3><p>An inner join takes only the rows in which a particular attribute (or list of attributes) can be found in both the left and right tables.</p><ul><li><p>For example, an inner join on the <code>sid</code> attribute could be written out as <code>SELECT ... FROM a, b WHERE a.sid = b.sid</code>.</p></li><li><p>Inner join is the <strong>default behavior</strong> for the JOIN operation, which looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> ...
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> a <span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> b
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> a.sid <span style=color:#f92672>=</span> b.sid
</span></span><span style=display:flex><span>...
</span></span></code></pre></div></li></ul><p>In the example below, we only keep the clubs CSM and OCF, and only keep the members that are in those two clubs:
<img src=https://notes.bencuan.me/cs186/Pasted%20image%2020230107122849.png width=auto alt></p><h3 id=natural-join>Natural Join
<a class=anchor href=#natural-join>#</a></h3><p>A <code>NATURAL JOIN</code> automatically inner joins tables on whichever attributes share the same name between the two tables.</p><p>If the columns <code>alias</code> and <code>club</code> were both named the same thing, then <code>SELECT ... FROM a NATURAL JOIN b ...</code> is completely equivalent to the example in the inner join section above. Otherwise, the NATURAL JOIN will return an empty table if no column names are shared (even if the contents are the same).</p><h3 id=outer-join>Outer Join
<a class=anchor href=#outer-join>#</a></h3><p>Left outer joins return all matched rows (as in an inner join), AND additionally preserves all unmatched rows from the left table. Any non-matching fields will be filled in with null values.
<img src=https://notes.bencuan.me/cs186/Pasted%20image%2020230107123046.png width=auto alt></p><p>A right outer join is the same as the left outer join, except it preserves unmatched rows from the right table instead. Flipping the table order on a left outer join creates an equivalent right outer join:
<img src=https://notes.bencuan.me/cs186/Pasted%20image%2020230107123142.png width=auto alt></p><p>A full outer join returns all rows, matched or unmatched, from the tables on both sides of the join clause.</p><h2 id=advanced-mechanics>Advanced Mechanics
<a class=anchor href=#advanced-mechanics>#</a></h2><h3 id=string-comparisons>String Comparisons
<a class=anchor href=#string-comparisons>#</a></h3><p>Using the <code>LIKE</code> operator, we can do the following:</p><ul><li>Match any single character: <code>_</code></li><li>Match zero, one. or multiple characters: <code>%</code></li><li>Example: <code>WHERE name LIKE 'B_%'</code> will match all rows with a name starting with a B and are at least 2 characters long</li></ul><h3 id=unions-and-intersections>Unions and Intersections
<a class=anchor href=#unions-and-intersections>#</a></h3><p>The <code>UNION</code> operator combines two queries (like an OR statement).</p><p>The <code>INTERSECT</code> operator combines two queries, and discards rows that do not appear in both (like an AND statement).</p><p>The <code>EXCEPT</code> operator subtracts one query’s results from another.</p><p>UNION, INTERSECT, and EXCEPT operate using <strong>set semantics</strong> (distinct elements) and will keep only one of each unique element in the result.</p><p>Using UNION ALL, INTERSECT ALL, and EXCEPT ALL will manage <strong>cardinalities</strong> and will add or subtract the number of identical elements accordingly.</p><ul><li>UNION ALL = sum of cardinalities</li><li>INTERSECT ALL = minimum of cardinalities</li><li>EXCEPT ALL = difference of cardinalities</li></ul><h3 id=nested-queries>Nested Queries
<a class=anchor href=#nested-queries>#</a></h3><p>The <code>IN</code> operator allows subqueries to be made. For example, we can <code>SELECT ... FROM ... WHERE id IN (SELECT .....)</code></p><ul><li>The <code>EXISTS</code> keyword can be used in place of <code>IN</code> to make <strong>correlated subqueries</strong> where the table in the subquery interacts with the outer query.</li><li><code>ANY</code> and <code>ALL</code> can be used as well: <code>SELECT * FROM a WHERE a.value > ANY (subquery...)</code> would only keep rows in <code>a</code> that are bigger than the smallest value in the subquery.</li><li><code>ALL</code> can be used to compute an argmax: for example, if we want a sailor with the highest rating, we can <code>SELECT * FROM s WHERE s.rating >= ALL(SELECT s2.rating FROM s s2)</code></li></ul><h3 id=views>Views
<a class=anchor href=#views>#</a></h3><p>A view is a <strong>named query.</strong> It can be thought of as a temporary table that can be accessed in future queries to make development simpler. Unlike tables, it is not computed immediately, and results are cached when they are needed.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>VIEW</span> name
</span></span><span style=display:flex><span><span style=color:#66d9ef>AS</span> <span style=color:#66d9ef>SELECT</span> ...
</span></span></code></pre></div><p>A “view on the fly” can also be created using the <code>WITH</code> keyword:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>WITH</span> name(col1, col2) <span style=color:#66d9ef>AS</span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>SELECT</span> ...), 
</span></span><span style=display:flex><span>name2(col1, col2) <span style=color:#66d9ef>AS</span> (<span style=color:#66d9ef>SELECT</span> ...),
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> ...
</span></span></code></pre></div><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/cs186// data-ctx="SQL syntax" data-src=/cs186/ class=internal-link>Welcome to CS186!</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://notes.bencuan.me/quartz/js/graph.cbd78cfa87df7d3e230d16fc24f06548.js></script></div></div><div id=contact_buttons><footer><p>Made with <a href=https://github.com/64bitpandas/amethyst>Amethyst</a>, © 2023 Ben Cuan</p><ul><li><a href=https://notes.bencuan.me/>Home</a></li><li><a href=https://github.com/64bitpandas/notes/issues>Feedback</a></li><li><a href=https://bencuan.me>Website</a></li></ul></footer></div></article><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#what-is-sql>What is SQL?</a><ul><li><a href=#terminology>Terminology</a></li><li><a href=#a-note-on-looking-up-sql-things-online>A note on looking up SQL things online</a></li><li><a href=#running-sql-queries>Running SQL queries</a></li><li><a href=#pedagogy-note>Pedagogy note</a></li></ul></li><li><a href=#keys>Keys</a><ul><li><a href=#primary-keys>Primary Keys</a></li><li><a href=#foreign-keys>Foreign Keys</a></li></ul></li><li><a href=#writing-queries>Writing Queries</a><ul><li><a href=#create-table>Create Table</a></li><li><a href=#insert-values>Insert Values</a></li><li><a href=#basic-querying>Basic Querying</a></li><li><a href=#aggregation>Aggregation</a></li><li><a href=#practice-problems>Practice Problems</a></li></ul></li><li><a href=#logical-processing-order>Logical Processing Order</a><ul><li><a href=#a-note-on-aliasing>A note on aliasing</a></li></ul></li><li><a href=#joins>Joins</a><ul><li><a href=#cartesian-product>Cartesian Product</a></li><li><a href=#inner-join>Inner Join</a></li><li><a href=#natural-join>Natural Join</a></li><li><a href=#outer-join>Outer Join</a></li></ul></li><li><a href=#advanced-mechanics>Advanced Mechanics</a><ul><li><a href=#string-comparisons>String Comparisons</a></li><li><a href=#unions-and-intersections>Unions and Intersections</a></li><li><a href=#nested-queries>Nested Queries</a></li><li><a href=#views>Views</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>